// apps/web/src/app/api/debug/env/route.ts
import { NextResponse } from "next/server";

export const runtime = "nodejs";
export const dynamic = "force-dynamic";

const mask = (v?: string | null) =>
  !v ? null : { len: v.length, head: v.slice(0, 5), tail: v.slice(-3) };

export async function GET() {
  return NextResponse.json({
    NODE_ENV: process.env.NODE_ENV,
    hasOpenAI: !!process.env.OPENAI_API_KEY,
    OPENAI_API_KEY: mask(process.env.OPENAI_API_KEY),
  });
}

// damit Next keine 405 wirft:
export async function HEAD() { return new Response(null, { status: 200 }); }
export async function OPTIONS() { 
  return new Response(null, { status: 204, headers: { Allow: "GET,HEAD,OPTIONS" } }); 
}
